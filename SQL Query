Create database Hospitality_dashboard;

# 1. How do you retrieve the total revenue realized from the fact_bookings table?
## 1. Total Revenue
Select SUM(Revenue_realized) as Total_Revenue_realized  from Fact_bookings;


-- 2.How do you determine the total number of bookings that have occurred?
SELECT COUNT(*) AS Total_Bookings
FROM fact_bookings;


-- 3. How do you calculate the total capacity of rooms present in all hotels?
SELECT SUM(capacity) AS Total_Room_Capacity
FROM fact_aggregated_bookings;


-- 4.How do you determine the total number of successful bookings that have occurred across all hotels?
SELECT SUM(successful_bookings) AS Total_Successful_Bookings
FROM fact_aggregated_bookings;



## 2. Occupancy
-- 5 .How do you calculate the occupancy rate, defined as the ratio of total successful bookings to the total rooms available (capacity), across all hotels?
SELECT SUM(successful_bookings) / SUM(capacity) * 100 AS Occupancy_Rate
FROM fact_aggregated_bookings;

-- 6 How do you calculate the average ratings given by customers for hotel services?
SELECT AVG(ratings_given) AS Average_Rating
FROM fact_bookings;

-- 7 How many days of data are present in the dataset from May to July?##
SELECT DATEDIFF('2024-07-31', '2024-05-01') + 1 AS total_days;

## 3. Cancellation Rate

-- 8.How do you calculate the total number of "Cancelled" bookings as a proportion of all bookings that have occurred?
SELECT COUNT(*) AS Total_Cancelled_Bookings
FROM fact_bookings
WHERE booking_status = 'Cancelled';

-- 9.How do you calculate the cancellation percentage, defined as the ratio of cancelled bookings to total bookings?
-- Cancellation Rate = Total CancelledBooking/Total Booking	
SELECT 
        (SELECT COUNT(*) FROM Fact_bookings WHERE Booking_Status = 'Cancelled') 
        / (SELECT COUNT(*) FROM Fact_bookings) * 100 AS Cancellation_rate;
        


# 4. Total Booking
Select Count(booking_id) as Total_Booking from fact_bookings;

-- 10.How do you calculate the total number of successful 'Checked out' bookings as a proportion of all bookings that have occurred?
SELECT COUNT(*) AS Total_Checked_Out_Bookings
FROM fact_bookings
WHERE booking_status = 'Checked Out';


-- 11.How do you calculate the total number of "No Show" bookings, defined as bookings where customers neither cancelled nor attended their booked rooms, as a proportion of all bookings that have occurred?
SELECT COUNT(*) AS Total_No_Show_Bookings
FROM fact_bookings
WHERE booking_status = 'No Show';

-- 12.How do you calculate the no show percentage, defined as the ratio of "No Show" bookings to total bookings?
SELECT (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM fact_bookings)) AS No_Show_Percentage
FROM fact_bookings
WHERE booking_status = 'No Show';


-- 13.How do you calculate the percentage contribution of each booking platform for bookings in hotels?
SELECT 
    booking_platform, 
    COUNT(*) * 100.0 / (SELECT COUNT(*) FROM fact_bookings) AS Booking_Platform_Contribution_Percentage
FROM 
    fact_bookings
GROUP BY 
    booking_platform;



## 6. Trend Analysis
-- 14. How can we analyze the trend of total revenue by week number and month?
Select Dim_date.week_no, Dim_date.month, SUM(Revenue_realized) as Total_revenue
FROM fact_bookings
        JOIN Dim_date ON fact_bookings.check_in_date = Dim_date.Date
GROUP BY 1, 2;

## 7. Weekday and weekend Revenue and Booking	
-- 15. What are the weekday and weekend revenue and booking trends?
SELECT 
    Dim_date.Day_type,
    COUNT(dim_date.Day_type) AS Total_Bookings,
    SUM(revenue_realized) AS Total_Revenue
FROM fact_bookings
        JOIN Dim_date ON fact_bookings.check_in_date = Dim_date.Date
GROUP BY Day_type;


## 8. Revenue by State and Hotel	
-- 16. What is the total revenue generated by each hotel and city?
Select Dim_hotels.property_name, Dim_hotels.City, SUM(Revenue_realized) as Total_revenue 
FROM fact_bookings
        JOIN Dim_hotels ON fact_bookings.property_id = Dim_hotels.property_id
        Group by City, property_name;
        
        
## 9. Class wise revenue and contribution of each room class over the total rooms booked
-- 17. What is the total revenue and contribution of each room class over the total rooms booked?
Select Dim_rooms.Room_class, SUM(Revenue_realized) as Total_revenue
FROM fact_bookings
        JOIN Dim_rooms ON fact_bookings.room_category = Dim_rooms.room_id
Group by 1;



-- 18. How do you calculate the percentage contribution of each room class over the total rooms booked?
SELECT 
    room_class, 
    COUNT(*) * 100.0 / (SELECT COUNT(*) FROM fact_bookings) AS Room_Class_Contribution_Percentage
FROM 
    fact_bookings fb
JOIN 
    dim_rooms dr ON fb.room_category = dr.room_id
GROUP BY 
    room_class;   



-- 19. How do you calculate the Average Daily Rate (ADR), defined as the ratio of revenue to the total rooms booked/sold?
SELECT 
    SUM(revenue_realized) / COUNT(DISTINCT check_in_date) AS ADR
FROM 
    fact_bookings; 



## 10. Checked out/Cancel/No Show (Booking Status)
-- 20. What are the counts of checked-out, canceled, and no-show bookings by booking status?
Select Booking_status, Count(Booking_status) from fact_bookings Group by 1;
    
    
-- 21. How do you calculate the realization percentage, defined as the percentage of successful "Checked Out" bookings over all bookings that have occurred?
SELECT 
    (COUNT(*) * 100.0 / (SELECT COUNT(*) FROM fact_bookings WHERE booking_status IN ('Checked Out', 'No Show'))) AS Realization_Percentage
FROM 
    fact_bookings
WHERE 
    booking_status = 'Checked Out';
    

    
-- 22. How do you calculate the Revenue Per Available Room (RevPAR), representing the revenue generated per available room, regardless of whether they are occupied?
SELECT 
    SUM(revenue_realized) / SUM(capacity) AS RevPAR
FROM 
    fact_bookings fb
JOIN 
    fact_aggregated_bookings fab ON fb.property_id = fab.property_id;
    

-- 25 How do you calculate the Daily Utilized Room Nights (DURN), representing on average how many rooms are successfully utilized by customers per day over a specific time period?
SELECT 
    SUM(fact_aggregated_bookings.successful_bookings) / DATEDIFF(MAX(fact_bookings.checkout_date),
    MIN(fact_bookings.check_in_date)) AS DURN
FROM   fact_bookings join fact_aggregated_bookings on fact_bookings.property_id = fact_aggregated_bookings.property_id;    

    




















